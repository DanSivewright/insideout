"use strict";(self.webpackChunkpayload_template_ts_blank=self.webpackChunkpayload_template_ts_blank||[]).push([[655],{18156:(e,t)=>{for(var l="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),n={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},a={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:l?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},r={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=1;i<20;i++)r["f"+i]=111+i;function o(e,t,l){t&&!("byKey"in t)&&(l=t,t=null),Array.isArray(e)||(e=[e]);var n=e.map((function(e){return s(e,t)})),a=function(e){return n.some((function(t){return c(t,e)}))};return null==l?a:a(l)}function s(e,t){var l=t&&t.byKey,i={},o=(e=e.replace("++","+add")).split("+"),s=o.length;for(var c in n)i[n[c]]=!1;var h=!0,m=!1,p=void 0;try{for(var f,v=o[Symbol.iterator]();!(h=(f=v.next()).done);h=!0){var g=f.value,E=g.endsWith("?")&&g.length>1;E&&(g=g.slice(0,-1));var y=u(g),w=n[y];if(g.length>1&&!w&&!a[g]&&!r[y])throw new TypeError('Unknown modifier: "'+g+'"');1!==s&&w||(l?i.key=y:i.which=d(g)),w&&(i[w]=!E||null)}}catch(e){m=!0,p=e}finally{try{!h&&v.return&&v.return()}finally{if(m)throw p}}return i}function c(e,t){for(var l in e){var n=e[l],a=void 0;if(null!=n&&((null!=(a="key"===l&&null!=t.key?t.key.toLowerCase():"which"===l?91===n&&93===t.which?91:t.which:t[l])||!1!==n)&&a!==n))return!1}return!0}function d(e){return e=u(e),r[e]||e.toUpperCase().charCodeAt(0)}function u(e){return e=e.toLowerCase(),e=a[e]||e}t.ZP=o},91655:(e,t,l)=>{l.r(t),l.d(t,{default:()=>$t});var n=l(67294),a=l(18156),r=l(94822),i=l(78872),o=l(90111),s={isHistory:e=>(0,o.P)(e)&&Array.isArray(e.redos)&&Array.isArray(e.undos)&&(0===e.redos.length||r.OX.isOperationList(e.redos[0]))&&(0===e.undos.length||r.OX.isOperationList(e.undos[0]))},c=(new WeakMap,new WeakMap),d=new WeakMap,u={isHistoryEditor:e=>s.isHistory(e.history)&&r.ML.isEditor(e),isMerging:e=>d.get(e),isSaving:e=>c.get(e),redo(e){e.redo()},undo(e){e.undo()},withoutMerging(e,t){var l=u.isMerging(e);d.set(e,!1),t(),d.set(e,l)},withoutSaving(e,t){var l=u.isSaving(e);c.set(e,!1),t(),c.set(e,l)}},h=(e,t)=>"set_selection"===e.type||(!(!t||"insert_text"!==e.type||"insert_text"!==t.type||e.offset!==t.offset+t.text.length||!r.y$.equals(e.path,t.path))||!(!t||"remove_text"!==e.type||"remove_text"!==t.type||e.offset+e.text.length!==t.offset||!r.y$.equals(e.path,t.path))),m=(e,t)=>"set_selection"!==e.type||null!=e.properties&&null!=e.newProperties,p=(e,t)=>!(!t||"set_selection"!==e.type||"set_selection"!==t.type),f=e=>"set_selection"!==e.type,v=l(26793),g=l(35193),E=l(48170),y=l(90546),w=l.n(y),b=l(953),N=l(90666);const x=(e,t)=>{const l=r.ML.marks(e);return!!l&&!0===l[t]},k=(e,t)=>{x(e,t)?r.ML.removeMark(e,t):r.ML.addMark(e,t,!0)};l(43318);const _="rich-text__button",M=({format:e,children:t})=>{const l=(0,i.ui)();return n.createElement("button",{type:"button",className:[_,x(l,e)&&`${_}__button--active`].filter(Boolean).join(" "),onMouseDown:t=>{t.preventDefault(),k(l,e)}},t)},L=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic bold-icon"},n.createElement("path",{className:"fill",d:"M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"}),n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),R=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic inline-code-icon"},n.createElement("path",{className:"fill",d:"M7.375 16.781l1.25-1.562L4.601 12l4.024-3.219-1.25-1.562-5 4a1 1 0 000 1.562l5 4zm9.25-9.562l-1.25 1.562L19.399 12l-4.024 3.219 1.25 1.562 5-4a1 1 0 000-1.562l-5-4zM14.976 3.216l-4 18-1.953-.434 4-18z"})),S=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic italic-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"})),T=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic strikethrough-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M10 19h4v-3h-4v3zM5 4v3h5v3h4V7h5V4H5zM3 14h18v-2H3v2z"})),B=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic underline-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"})),O={bold:{Button:()=>n.createElement(M,{format:"bold"},n.createElement(L,null)),Leaf:({attributes:e,children:t})=>n.createElement("strong",{...e},t)},code:{Button:()=>n.createElement(M,{format:"code"},n.createElement(R,null)),Leaf:({attributes:e,children:t})=>n.createElement("code",{...e},t)},italic:{Button:()=>n.createElement(M,{format:"italic"},n.createElement(S,null)),Leaf:({attributes:e,children:t})=>n.createElement("em",{...e},t)},strikethrough:{Button:()=>n.createElement(M,{format:"strikethrough"},n.createElement(T,null)),Leaf:({attributes:e,children:t})=>n.createElement("del",{...e},t)},underline:{Button:()=>n.createElement(M,{format:"underline"},n.createElement(B,null)),Leaf:({attributes:e,children:t})=>n.createElement("u",{...e},t)}};var C=l(94654);const $=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic h1-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2V9h-2V7h4v10z"})),z={Button:()=>n.createElement(C.Z,{format:"h1"},n.createElement($,null)),Element:({attributes:e,children:t})=>n.createElement("h1",{...e},t)},H=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic h2-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 8a2 2 0 01-2 2h-2v2h4v2H9v-4a2 2 0 012-2h2V9H9V7h4a2 2 0 012 2v2z"})),Z={Button:()=>n.createElement(C.Z,{format:"h2"},n.createElement(H,null)),Element:({attributes:e,children:t})=>n.createElement("h2",{...e},t)},D=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic h3-icon"},n.createElement("path",{fill:"none",d:"M.01 0h24v24h-24z"}),n.createElement("path",{className:"fill",d:"M19.01 3h-14c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 7.5c0 .83-.67 1.5-1.5 1.5.83 0 1.5.67 1.5 1.5V15a2 2 0 01-2 2h-4v-2h4v-2h-2v-2h2V9h-4V7h4a2 2 0 012 2v1.5z"})),P={Button:()=>n.createElement(C.Z,{format:"h3"},n.createElement(D,null)),Element:({attributes:e,children:t})=>n.createElement("h3",{...e},t)},Y=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic h4-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 14h-2v-4H9V7h2v4h2V7h2v10z"})),j={Button:()=>n.createElement(C.Z,{format:"h4"},n.createElement(Y,null)),Element:({attributes:e,children:t})=>n.createElement("h4",{...e},t)},W=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic h5-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 6h-4v2h2a2 2 0 012 2v2a2 2 0 01-2 2H9v-2h4v-2H9V7h6v2z"})),V={Button:()=>n.createElement(C.Z,{format:"h5"},n.createElement(W,null)),Element:({attributes:e,children:t})=>n.createElement("h5",{...e},t)},A=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic h6-icon"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M11 15h2v-2h-2v2zm8-12H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 6h-4v2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V9a2 2 0 012-2h4v2z"})),F={Button:()=>n.createElement(C.Z,{format:"h6"},n.createElement(A,null)),Element:({attributes:e,children:t})=>n.createElement("h6",{...e},t)},U=e=>{r.YR.unwrapNodes(e,{match:e=>r.W_.isElement(e)&&"link"===e.type})};var I=l(71851);const q=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic link"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{className:"fill",d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}));var K=l(56490),X=l(9980),J=l(81311),G=l(30894),Q=l(84041);const ee=(0,l(78498).extractTranslations)(["fields:textToDisplay","fields:linkType","fields:chooseBetweenCustomTextOrDocument","fields:customURL","fields:internalLink","fields:enterURL","fields:chooseDocumentToLink","fields:openInNewTab"]),te=e=>[{name:"text",label:ee["fields:textToDisplay"],type:"text",required:!0},{name:"linkType",label:ee["fields:linkType"],type:"radio",required:!0,admin:{description:ee["fields:chooseBetweenCustomTextOrDocument"]},defaultValue:"custom",options:[{label:ee["fields:customURL"],value:"custom"},{label:ee["fields:internalLink"],value:"internal"}]},{name:"url",label:ee["fields:enterURL"],type:"text",required:!0,admin:{condition:({linkType:e,url:t})=>void 0===e&&t||"custom"===e}},{name:"doc",label:ee["fields:chooseDocumentToLink"],type:"relationship",required:!0,relationTo:e.collections.map((({slug:e})=>e)),admin:{condition:({linkType:e})=>"internal"===e}},{name:"newTab",label:ee["fields:openInNewTab"],type:"checkbox"}];var le=l(80181),ne=l(33636),ae=l(26644),re=l(46268),ie=l(43814),oe=l(5590),se=(l(39686),l(69850));const ce="rich-text-link-edit-modal",de=({handleClose:e,handleModalSubmit:t,initialState:l,fieldSchema:a,drawerSlug:r})=>{const{t:i}=(0,v.$)("fields");return n.createElement(Q.dy,{slug:r,formatSlug:!1,className:ce},n.createElement(se.T,{className:`${ce}__template`},n.createElement("header",{className:`${ce}__header`},n.createElement("h2",{className:`${ce}__header-text`},i("editLink")),n.createElement(le.Z,{className:`${ce}__header-close`,buttonStyle:"none",onClick:e},n.createElement(ne.Z,null))),n.createElement(ae.Z,{onSubmit:t,initialState:l},n.createElement(oe.Z,{fieldTypes:ie.Z,readOnly:!1,fieldSchema:a,forceRender:!0}),n.createElement(re.Z,null,i("general:submit")))))};var ue=l(89116),he=l(95050),me=l(19826),pe=l(28630),fe=l(40684),ve=l(93582),ge=l(28960);l(24362);const Ee="rich-text-link",ye={Button:({fieldProps:e})=>{var t,l;const a=null===(l=null===(t=null==e?void 0:e.admin)||void 0===t?void 0:t.link)||void 0===l?void 0:l.fields,{t:o}=(0,v.$)(["upload","general"]),s=(0,i.ui)(),c=(0,X.Z)(),[d]=(0,n.useState)((()=>{const e=[...te(c)];return a&&e.push({name:"fields",type:"group",admin:{style:{margin:0,padding:0,borderTop:0,borderBottom:0}},fields:a}),e})),{openModal:u,closeModal:h}=(0,I.useModal)(),m=(0,n.useId)(),p=(0,G.D)(),f=(0,Q.CT)({slug:`rich-text-link-${m}`,depth:p});return n.createElement(n.Fragment,null,n.createElement(C.Z,{format:"link",tooltip:o("fields:addLink"),className:"link",onClick:()=>{(0,J.Z)(s,"link")?U(s):u(f)}},n.createElement(q,null)),n.createElement(de,{drawerSlug:f,handleModalSubmit:e=>{((e,t)=>{const l=e.selection&&r.e6.isCollapsed(e.selection),n=(0,K.default)(t,!0),a={type:"link",linkType:n.linkType,url:n.url,doc:n.doc,newTab:n.newTab,fields:n.fields,children:[]};l||!e.selection?r.YR.insertNodes(e,{...a,children:[{text:String(n.text)}]}):e.selection&&(r.YR.wrapNodes(e,a,{split:!0}),r.YR.delete(e,{at:e.selection.focus.path,unit:"word"}),r.YR.move(e,{distance:1,unit:"offset"}),r.YR.insertText(e,String(n.text),{at:e.selection.focus.path})),i.F3.focus(e)})(s,e),h(f)},fieldSchema:d,handleClose:()=>{h(f)}}))},Element:e=>{var t,l;const{attributes:a,children:o,element:s,editorRef:c,fieldProps:d}=e,u=null===(l=null===(t=null==d?void 0:d.admin)||void 0===t?void 0:t.link)||void 0===l?void 0:l.fields,h=(0,i.ui)(),m=(0,X.Z)(),{user:p}=(0,pe.a)(),f=(0,fe.bU)(),{t:g,i18n:E}=(0,v.$)("fields"),{openModal:y,toggleModal:w,closeModal:b}=(0,I.useModal)(),[N,x]=(0,n.useState)(!1),[k,_]=(0,n.useState)(!1),[M,L]=(0,n.useState)({}),[R]=(0,n.useState)((()=>{const e=[...te(m)];return u&&e.push({name:"fields",type:"group",admin:{style:{margin:0,padding:0,borderTop:0,borderBottom:0}},fields:u}),e})),S=(0,n.useId)(),T=(0,G.D)(),B=(0,Q.CT)({slug:`rich-text-link-${S}`,depth:T}),O=(0,n.useCallback)((e=>{e||_(e)}),[]);return(0,n.useEffect)((()=>{(async()=>{const e={text:r.NB.string(s),linkType:s.linkType,url:s.url,doc:s.doc,newTab:s.newTab,fields:(0,ve.Z)(s.fields)},t=await(0,me.Z)({fieldSchema:R,data:e,user:p,operation:"update",locale:f,t:g});L(t)})()}),[N,s,R,p,f,g]),n.createElement("span",{className:Ee,...a},n.createElement("span",{style:{userSelect:"none"},contentEditable:!1},N&&n.createElement(de,{drawerSlug:B,fieldSchema:R,handleClose:()=>{w(B),x(!1)},handleModalSubmit:e=>{((e,t,l)=>{const n=(0,K.default)(t,!0),[,a]=r.ML.above(e),o={newTab:n.newTab,url:n.url,linkType:n.linkType,doc:n.doc};l&&(o.fields=n.fields),r.YR.setNodes(e,o,{at:a}),r.YR.delete(e,{at:e.selection.focus.path,unit:"block"}),r.YR.move(e,{distance:1,unit:"offset"}),r.YR.insertText(e,String(n.text),{at:e.selection.focus.path}),i.F3.focus(e)})(h,e,u),b(B)},initialState:M}),n.createElement(he.Z,{buttonType:"none",size:"small",forceOpen:k,onToggleOpen:O,horizontalAlign:"left",verticalAlign:"bottom",boundingRef:c,render:()=>{var e,t,l,a;return n.createElement("div",{className:"rich-text-link__popup"},"internal"===s.linkType&&(null===(e=s.doc)||void 0===e?void 0:e.relationTo)&&(null===(t=s.doc)||void 0===t?void 0:t.value)&&n.createElement(ue.c,{i18nKey:"fields:linkedTo",values:{label:(0,ge.i)(null===(a=null===(l=m.collections.find((({slug:e})=>e===s.doc.relationTo)))||void 0===l?void 0:l.labels)||void 0===a?void 0:a.singular,E)}},n.createElement("a",{className:"rich-text-link__link-label",href:`${m.routes.admin}/collections/${s.doc.relationTo}/${s.doc.value}`,target:"_blank",rel:"noreferrer"},"label")),("custom"===s.linkType||!s.linkType)&&n.createElement("a",{className:"rich-text-link__link-label",href:s.url,target:"_blank",rel:"noreferrer"},s.url),n.createElement(le.Z,{className:"rich-text-link__link-edit",icon:"edit",round:!0,buttonStyle:"icon-label",onClick:e=>{e.preventDefault(),_(!1),y(B),x(!0)},tooltip:g("general:edit")}),n.createElement(le.Z,{className:"rich-text-link__link-close",icon:"x",round:!0,buttonStyle:"icon-label",onClick:e=>{e.preventDefault(),U(h)},tooltip:g("general:remove")}))}})),n.createElement("span",{tabIndex:0,role:"button",className:["rich-text-link__popup-toggler"].filter(Boolean).join(" "),onKeyDown:e=>{"Enter"===e.key&&_(!0)},onClick:()=>_(!0)},o))},plugins:[e=>{const t=e,{isInline:l}=t;return t.isInline=e=>"link"===e.type||l(e),t}]},we=(e,t)=>{const l=r.ML.unhangRange(e,e.selection,{voids:!0}),[n,a]=r.NB.common(e,l.anchor.path,l.focus.path);return r.ML.isBlock(e,n)||r.ML.isEditor(n)?[n,a]:r.ML.above(e,{at:a,match:t||(t=>r.ML.isBlock(e,t)||r.ML.isEditor(t))})},be=(e,t)=>{if(!e.selection)return!1;const[l,n]=we(e);if(r.ML.isEditor(l))return!1;const[a]=Array.from(r.ML.nodes(e,{at:n,mode:"lowest",match:(e,l)=>!r.ML.isEditor(e)&&r.W_.isElement(e)&&e.type===t&&l.length>=n.length-2}));return!!a},Ne=["ol","ul"],xe=e=>Array.isArray(e.children)&&e.children.every((e=>r.W_.isElement(e))),ke=(e,t)=>{r.YR.setNodes(e,{type:void 0},{at:t,match:(e,l)=>{const n=xe(e);return!r.ML.isEditor(e)&&r.W_.isElement(e)&&!n&&"li"===e.type&&l.length===t.length+1}}),r.YR.unwrapNodes(e,{at:t,match:(e,l)=>{const n=xe(e);return!r.ML.isEditor(e)&&r.W_.isElement(e)&&n&&"li"===e.type&&l.length===t.length+1}}),r.YR.unwrapNodes(e,{match:e=>r.W_.isElement(e)&&Ne.includes(e.type),mode:"lowest"})},_e=(e,t)=>{let l;if(be(e,"ol")&&(l="ol"),be(e,"ul")&&(l="ul"),l===t){const l=r.NB.descendant(e,e.selection.anchor.path);if(r.xv.isText(l)&&0===String(l.text).length)r.YR.unwrapNodes(e,{match:e=>r.W_.isElement(e)&&Ne.includes(e.type),split:!0,mode:"lowest"}),r.YR.setNodes(e,{type:void 0});else{const[,l]=we(e,(e=>r.W_.isElement(e)&&e.type===t));ke(e,l)}}else if(l&&l!==t)r.YR.setNodes(e,{type:t},{match:e=>r.W_.isElement(e)&&Ne.includes(e.type),mode:"lowest"});else{r.YR.wrapNodes(e,{type:t,children:[]});const[,l]=we(e,(e=>r.W_.isElement(e)&&e.type===t));r.YR.setNodes(e,{type:"li"},{voids:!0,match:(e,t)=>r.W_.isElement(e)&&void 0===e.type&&t.length===l.length+1});Array.from(r.ML.nodes(e,{match:(e,t)=>r.W_.isElement(e)&&void 0!==e.type&&"li"!==e.type&&t.length===l.length+1})).forEach((([,t])=>{r.YR.wrapNodes(e,{type:"li",children:[]},{at:t})}))}i.F3.focus(e)},Me="rich-text__button",Le=({format:e,children:t,onClick:l,className:a})=>{const r=(0,i.ui)(),o=(0,n.useCallback)((t=>{t.preventDefault(),_e(r,e)}),[r,e]);return n.createElement("button",{type:"button",className:[Me,a,be(r,e)&&`${Me}__button--active`].filter(Boolean).join(" "),onClick:l||o},t)},Re=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic ordered-list-icon"},n.createElement("path",{className:"fill",d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"}),n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}));l(99529);const Se={Button:()=>n.createElement(Le,{format:"ol"},n.createElement(Re,null)),Element:({attributes:e,children:t})=>n.createElement("ol",{className:"rich-text-ol",...e},t)},Te=()=>n.createElement("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"graphic unordered-list-icon"},n.createElement("path",{className:"fill",d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"}),n.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}));l(88767);const Be={Button:()=>n.createElement(Le,{format:"ul"},n.createElement(Te,null)),Element:({attributes:e,children:t})=>n.createElement("ul",{className:"rich-text-ul",...e},t)},Oe={Element:e=>{var t,l;const{attributes:a,element:r,children:i}=e,o=r.children.length>=1&&Ne.includes(null===(l=null===(t=r.children)||void 0===t?void 0:t[0])||void 0===l?void 0:l.type);return n.createElement("li",{style:{listStyle:o?"none":void 0},...a},i)}};l(30958);const Ce=()=>n.createElement("svg",{className:"icon icon--indent-left",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25"},n.createElement("path",{d:"M16.005 9.61502L21.005 13.1864L21.005 6.04361L16.005 9.61502Z",className:"fill"}),n.createElement("rect",{x:"5",y:"5.68199",width:"9.0675",height:"2.15625",className:"fill"}),n.createElement("rect",{x:"5",y:"11.4738",width:"9.0675",height:"2.15625",className:"fill"}),n.createElement("rect",{x:"5",y:"17.2656",width:"16.005",height:"2.15625",className:"fill"}));l(73928);const $e=()=>n.createElement("svg",{className:"icon icon--indent-right",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25"},n.createElement("path",{d:"M10 9.61502L5 6.04361L5 13.1864L10 9.61502Z",className:"fill"}),n.createElement("rect",{x:"11.9375",y:"5.68199",width:"9.0675",height:"2.15625",className:"fill"}),n.createElement("rect",{x:"11.9375",y:"11.4738",width:"9.0675",height:"2.15625",className:"fill"}),n.createElement("rect",{x:"5",y:"17.2656",width:"16.005",height:"2.15625",className:"fill"})),ze="indent",He={Button:()=>{const e=(0,i.ui)(),t=(0,n.useCallback)(((t,l)=>{if(t.preventDefault(),"left"===l)if((0,J.Z)(e,"li")){const[,t]=we(e,(e=>r.W_.isElement(e)&&Ne.includes(e.type))),l=r.ML.above(e,{at:t,match:t=>!r.ML.isEditor(t)&&r.ML.isBlock(e,t)});if(l){const[t,n]=l;if(t.children.length>1){r.YR.unwrapNodes(e,{at:n,match:(e,t)=>!r.ML.isEditor(e)&&r.W_.isElement(e)&&Ne.includes(e.type)&&t.length===n.length+1}),r.YR.setNodes(e,{type:"li"},{at:n,match:(e,t)=>!r.ML.isEditor(e)&&r.W_.isElement(e)&&"li"!==e.type&&t.length===n.length+1});const[t]=r.ML.node(e,n);r.W_.isElement(t)&&"li"===t.type&&r.YR.liftNodes(e,{at:n,match:(e,t)=>!r.ML.isEditor(e)&&r.W_.isElement(e)&&t.length===n.length+1&&"li"===e.type})}else r.YR.unwrapNodes(e,{at:n,match:(e,t)=>r.W_.isElement(e)&&"li"===e.type&&t.length===n.length}),r.YR.unwrapNodes(e,{match:e=>r.W_.isElement(e)&&Ne.includes(e.type)})}else ke(e,t)}else r.YR.unwrapNodes(e,{match:e=>r.W_.isElement(e)&&e.type===ze,split:!0,mode:"lowest"});if("right"===l){const t=(0,J.Z)(e,"ol"),l=(0,J.Z)(e,"ul");if(t||l){const[[,l]]=Array.from(r.ML.nodes(e,{mode:"lowest",match:e=>r.W_.isElement(e)&&"li"===e.type}));if(l[l.length-1]>0){const[,n]=r.ML.previous(e,{at:l}),[a]=r.ML.node(e,[...n,0]);r.xv.isText(a)&&r.YR.wrapNodes(e,{children:[]},{at:[...n,0]}),r.YR.moveNodes(e,{to:[...n,1],match:e=>r.W_.isElement(e)&&"li"===e.type,mode:"lowest"}),r.YR.wrapNodes(e,{type:t?"ol":"ul",children:[]},{match:e=>r.W_.isElement(e)&&"li"===e.type,mode:"lowest"})}else r.YR.wrapNodes(e,{type:t?"ol":"ul",children:[{type:"li",children:[]}]},{match:e=>r.W_.isElement(e)&&"li"===e.type,mode:"lowest"})}else r.YR.wrapNodes(e,{type:ze,children:[]})}i.F3.focus(e)}),[e]),l=(0,J.Z)(e,"li")||(0,J.Z)(e,ze);return n.createElement(n.Fragment,null,n.createElement("button",{type:"button",className:[C.M,!l&&`${C.M}--disabled`].filter(Boolean).join(" "),onClick:l?e=>t(e,"left"):void 0},n.createElement(Ce,null)),n.createElement("button",{type:"button",className:C.M,onClick:e=>t(e,"right")},n.createElement($e,null)))},Element:({attributes:e,children:t})=>n.createElement("div",{style:{paddingLeft:25},...e},t)},Ze=e=>{const t=e,{isVoid:l}=t;return t.isVoid=e=>"relationship"===e.type||l(e),t};var De=l(47489),Pe=l(39751),Ye=l(58987);l(16654);const je="rich-text-relationship",We={depth:0},Ve=e=>{var t,l,a,o,s,c;const{attributes:d,children:u,element:h,fieldProps:m}=e,{relationTo:p,value:f}=h,{collections:g,serverURL:E,routes:{api:y}}=(0,X.Z)(),[w]=(0,n.useState)((()=>g.filter((({admin:{enableRichTextRelationship:e}})=>e)).map((({slug:e})=>e)))),[b,N]=(0,n.useState)((()=>g.find((e=>e.slug===p)))),x=(0,i.vt)(),k=(0,i.UE)(),{t:_,i18n:M}=(0,v.$)(["fields","general"]),L=(0,i._7)(),[R,S]=(0,n.useReducer)((e=>e+1),0),[{data:T},{setParams:B}]=(0,De.Z)(`${E}${y}/${b.slug}/${null==f?void 0:f.id}`,{initialParams:We}),[O,C,{closeDrawer:$}]=(0,Pe.Zr)({collectionSlug:b.slug,id:null==f?void 0:f.id}),[z,H,{closeDrawer:Z}]=(0,Ye.Ss)({collectionSlugs:w,selectedCollection:b.slug}),D=(0,n.useCallback)((()=>{const e=i.F3.findPath(L,h);r.YR.removeNodes(L,{at:e})}),[L,h]),P=n.useCallback((({doc:e})=>{const t=i.F3.findPath(L,h);r.YR.setNodes(L,{type:"relationship",value:{id:e.id},relationTo:b.slug,children:[{text:" "}]},{at:t}),B({...We,cacheBust:R}),$(),S()}),[L,h,b,R,B,$]),Y=n.useCallback((({docID:e,collectionConfig:t})=>{const l=i.F3.findPath(L,h);r.YR.setNodes(L,{type:"relationship",value:{id:e},relationTo:t.slug,children:[{text:" "}]},{at:l}),N(g.find((e=>e.slug===t.slug))),B({...We,cacheBust:R}),Z(),S()}),[Z,L,h,R,B,g]);return n.createElement("div",{className:[je,x&&k&&`${je}--selected`].filter(Boolean).join(" "),contentEditable:!1,...d},n.createElement("div",{className:`${je}__wrap`},n.createElement("p",{className:`${je}__label`},_("labelRelationship",{label:(0,ge.i)(b.labels.singular,M)})),n.createElement("p",{className:`${je}__title`},T[(null===(t=null==b?void 0:b.admin)||void 0===t?void 0:t.useAsTitle)||"id"])),n.createElement("div",{className:`${je}__actions`},(null==f?void 0:f.id)&&n.createElement(C,{className:`${je}__toggler`,disabled:null===(l=null==m?void 0:m.admin)||void 0===l?void 0:l.readOnly},n.createElement(le.Z,{icon:"edit",round:!0,buttonStyle:"icon-label",el:"div",className:`${je}__actionButton`,onClick:e=>{e.preventDefault()},tooltip:_("general:editLabel",{label:(0,ge.i)(b.labels.singular,M)}),disabled:null===(a=null==m?void 0:m.admin)||void 0===a?void 0:a.readOnly})),n.createElement(H,{disabled:null===(o=null==m?void 0:m.admin)||void 0===o?void 0:o.readOnly},n.createElement(le.Z,{icon:"swap",round:!0,buttonStyle:"icon-label",className:`${je}__actionButton`,onClick:()=>{},el:"div",tooltip:_("swapRelationship"),disabled:null===(s=null==m?void 0:m.admin)||void 0===s?void 0:s.readOnly})),n.createElement(le.Z,{icon:"x",round:!0,buttonStyle:"icon-label",className:`${je}__actionButton`,onClick:e=>{e.preventDefault(),D()},tooltip:_("fields:removeRelationship"),disabled:null===(c=null==m?void 0:m.admin)||void 0===c?void 0:c.readOnly})),(null==f?void 0:f.id)&&n.createElement(O,{onSave:P}),n.createElement(z,{onSelect:Y}),u)};l(13981);const Ae=()=>n.createElement("svg",{className:"icon icon--relationship",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25"},n.createElement("path",{d:"M19.0597 14.9691L19.0597 19.0946L6.01681 19.0946L6.01681 6.03028L10.0948 6.03028",className:"stroke",strokeWidth:"2"}),n.createElement("path",{d:"M19.0597 11.0039L19.0597 6.00387L14.0597 6.00387",className:"stroke",strokeWidth:"2"}),n.createElement("line",{x1:"18.7061",y1:"6.40767",x2:"13.0493",y2:"12.0645",className:"stroke",strokeWidth:"2"}));const Fe=(e,t)=>{const l=(e=>{var t,l;if(!e.selection)return!1;const n=Array.from(r.ML.nodes(e,{at:r.ML.unhangRange(e,e.selection),match:e=>!r.ML.isEditor(e)&&r.W_.isElement(e)&&(!e.type||"p"===e.type)})),a=null==n?void 0:n[(null==n?void 0:n.length)-1];return a&&r.W_.isElement(a[0])&&(!a[0].type||"p"===a[0].type)&&"text"in(null===(t=a[0].children)||void 0===t?void 0:t[0])&&""===(null===(l=a[0].children)||void 0===l?void 0:l[0].text)})(e),n=r.ML.previous(e);l?r.ML.isVoid(e,null==n?void 0:n[0])?(r.YR.insertNodes(e,{children:[{text:""}]}),r.YR.setNodes(e,t)):r.YR.setNodes(e,t):r.YR.insertNodes(e,t),r.YR.insertNodes(e,{children:[{text:""}]})};l(38723);const Ue={Button:()=>{const{collections:e}=(0,X.Z)(),{t}=(0,v.$)("fields"),l=(0,i.ui)(),[a]=(0,n.useState)((()=>e.filter((({admin:{enableRichTextRelationship:e}})=>e)).map((({slug:e})=>e)))),[r,o]=(0,n.useState)((()=>a[0])),[s,c,{closeDrawer:d,isDrawerOpen:u}]=(0,Ye.Ss)({collectionSlugs:a,selectedCollection:r}),h=(0,n.useCallback)((({docID:e,collectionConfig:t})=>{((e,{value:t,relationTo:l})=>{Fe(e,{type:"relationship",value:t,relationTo:l,children:[{text:" "}]}),i.F3.focus(e)})(l,{value:{id:e},relationTo:t.slug}),d()}),[l,d]);return(0,n.useEffect)((()=>{o(a[0])}),[u,a]),a&&0!==a.length?n.createElement(n.Fragment,null,n.createElement(c,null,n.createElement(C.Z,{className:"relationship-rich-text-button",format:"relationship",tooltip:t("addRelationship"),el:"div",onClick:()=>{}},n.createElement(Ae,null))),n.createElement(s,{onSelect:h})):null},Element:Ve,plugins:[Ze]},Ie=e=>{const t=e,{isVoid:l}=t;return t.isVoid=e=>"upload"===e.type||l(e),t};var qe=l(58499),Ke=l(75643);l(52835);const Xe="rich-text-upload",Je={depth:0},Ge=({attributes:e,children:t,element:l})=>{var a,o,s;const{relationTo:c,value:d,fieldProps:u}=l,{collections:h,serverURL:m,routes:{api:p}}=(0,X.Z)(),{t:f,i18n:g}=(0,v.$)("fields"),[E,y]=(0,n.useReducer)((e=>e+1),0),[w,b]=(0,n.useState)((()=>h.find((e=>e.slug===c)))),[N,x,{closeDrawer:k}]=(0,Ye.Ss)({uploads:!0,selectedCollection:w.slug}),[_,M,{closeDrawer:L}]=(0,Pe.Zr)({collectionSlug:w.slug,id:null==d?void 0:d.id}),R=(0,i._7)(),S=(0,i.vt)(),T=(0,i.UE)(),[{data:B},{setParams:O}]=(0,De.Z)(`${m}${p}/${w.slug}/${null==d?void 0:d.id}`,{initialParams:Je}),C=(0,Ke.Z)(w,B),$=(0,n.useCallback)((()=>{const e=i.F3.findPath(R,l);r.YR.removeNodes(R,{at:e})}),[R,l]),z=(0,n.useCallback)((e=>{const{doc:t}=e,n={fields:t},a=i.F3.findPath(R,l);r.YR.setNodes(R,n,{at:a}),O({...Je,cacheBust:E}),y(),L()}),[R,l,O,E,L]),H=n.useCallback((({docID:e,collectionConfig:t})=>{const n={type:"upload",value:{id:e},relationTo:t.slug,children:[{text:" "}]},a=i.F3.findPath(R,l);b(h.find((e=>e.slug===t.slug))),r.YR.setNodes(R,n,{at:a}),y(),k()}),[k,R,l,h]);return n.createElement("div",{className:[Xe,S&&T&&`${Xe}--selected`].filter(Boolean).join(" "),contentEditable:!1,...e},n.createElement("div",{className:`${Xe}__card`},n.createElement("div",{className:`${Xe}__topRow`},n.createElement("div",{className:`${Xe}__thumbnail`},C?n.createElement("img",{src:C,alt:null==B?void 0:B.filename}):n.createElement(qe.Z,null)),n.createElement("div",{className:`${Xe}__topRowRightPanel`},n.createElement("div",{className:`${Xe}__collectionLabel`},(0,ge.i)(w.labels.singular,g)),n.createElement("div",{className:`${Xe}__actions`},(null==d?void 0:d.id)&&n.createElement(M,{className:`${Xe}__toggler`},n.createElement(le.Z,{icon:"edit",round:!0,buttonStyle:"icon-label",el:"div",className:`${Xe}__actionButton`,onClick:e=>{e.preventDefault()},tooltip:f("general:editLabel",{label:w.labels.singular}),disabled:null===(a=null==u?void 0:u.admin)||void 0===a?void 0:a.readOnly})),n.createElement(x,null,n.createElement(le.Z,{icon:"swap",round:!0,buttonStyle:"icon-label",className:`${Xe}__actionButton`,onClick:()=>{},el:"div",tooltip:f("swapUpload"),disabled:null===(o=null==u?void 0:u.admin)||void 0===o?void 0:o.readOnly})),n.createElement(le.Z,{icon:"x",round:!0,buttonStyle:"icon-label",className:`${Xe}__actionButton`,onClick:e=>{e.preventDefault(),$()},tooltip:f("removeUpload"),disabled:null===(s=null==u?void 0:u.admin)||void 0===s?void 0:s.readOnly})))),n.createElement("div",{className:`${Xe}__bottomRow`},n.createElement("strong",null,null==B?void 0:B.filename))),t,(null==d?void 0:d.id)&&n.createElement(_,{onSave:z}),n.createElement(N,{onSelect:H}))};l(71168);const Qe=()=>n.createElement("svg",{className:"icon icon--upload",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25"},n.createElement("path",{d:"M20.06,5.12h-15v15h15Zm-2,2v7L15.37,11l-3.27,4.1-2-1.58-3,3.74V7.12Z",className:"fill"}),n.createElement("circle",{cx:"9.69",cy:"9.47",r:"0.97",className:"fill"}));l(59622);const et={h1:z,h2:Z,h3:P,h4:j,h5:V,h6:F,link:ye,ol:Se,ul:Be,li:Oe,indent:He,relationship:Ue,upload:{Button:()=>{const{t:e}=(0,v.$)(["upload","general"]),t=(0,i.ui)(),[l,a,{closeDrawer:r}]=(0,Ye.Ss)({uploads:!0}),o=(0,n.useCallback)((({docID:e,collectionConfig:l})=>{((e,{value:t,relationTo:l})=>{Fe(e,{type:"upload",value:t,relationTo:l,children:[{text:" "}]}),i.F3.focus(e)})(t,{value:{id:e},relationTo:l.slug}),r()}),[t,r]);return n.createElement(n.Fragment,null,n.createElement(a,null,n.createElement(C.Z,{className:"upload-rich-text-button",format:"upload",tooltip:e("fields:addUpload"),el:"div",onClick:()=>{}},n.createElement(Qe,null))),n.createElement(l,{onSelect:o}))},Element:Ge,plugins:[Ie]}},tt={"mod+b":"bold","mod+i":"italic","mod+u":"underline","mod+`":"code"},lt=(e,t)=>"function"==typeof t?t(e):e,nt=(e,t)=>t.reduce(((e,t)=>{if("object"==typeof t&&Array.isArray(t.plugins))return t.plugins.reduce(lt,e);if("string"==typeof t){if(et[t]&&et[t].plugins)return et[t].plugins.reduce(lt,e);if(O[t]&&O[t].plugins)return O[t].plugins.reduce(lt,e)}return e}),e);var at=l(92077),rt=l(77070);function it(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var ot=new WeakMap,st=new WeakMap;class ct{}class dt extends ct{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super();var{offset:t,path:l}=e;this.offset=t,this.path=l}}class ut extends ct{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super();var{offset:t,path:l}=e;this.offset=t,this.path=l}}var ht=e=>st.get(e);function mt(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,n)}return l}function pt(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(l),!0).forEach((function(t){it(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):mt(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}var ft=new WeakSet,vt=e=>{var t=[],l=e=>{if(null!=e){var n=t[t.length-1];if("string"==typeof e){var a={text:e};ft.add(a),e=a}if(r.xv.isText(e)){var i=e;r.xv.isText(n)&&ft.has(n)&&ft.has(i)&&r.xv.equals(n,i,{loose:!0})?n.text+=i.text:t.push(i)}else if(r.W_.isElement(e))t.push(e);else{if(!(e instanceof ct))throw new Error("Unexpected hyperscript child object: ".concat(e));var o=t[t.length-1];r.xv.isText(o)||(l(""),o=t[t.length-1]),e instanceof dt?((e,t)=>{var l=e.text.length;ot.set(e,[l,t])})(o,e):e instanceof ut&&((e,t)=>{var l=e.text.length;st.set(e,[l,t])})(o,e)}}};for(var n of e.flat(1/0))l(n);return t};function gt(e,t,l){return pt(pt({},t),{},{children:vt(l)})}function Et(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,n)}return l}function yt(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(l),!0).forEach((function(t){it(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):Et(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}var wt={anchor:function(e,t,l){return new dt(t)},cursor:function(e,t,l){return[new dt(t),new ut(t)]},editor:function(e,t,l){var n,a=[];for(var i of l)r.e6.isRange(i)?n=i:a.push(i);var o,s=vt(a),c={},d=(0,r.Jh)();for(var[u,h]of(Object.assign(d,t),d.children=s,r.NB.texts(d))){var m=(o=u,ot.get(o)),p=ht(u);if(null!=m){var[f]=m;c.anchor={path:h,offset:f}}if(null!=p){var[v]=p;c.focus={path:h,offset:v}}}if(c.anchor&&!c.focus)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<anchor />`. For collapsed selections, use `<cursor />` instead.");if(!c.anchor&&c.focus)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<focus />`. For collapsed selections, use `<cursor />` instead.");return null!=n?d.selection=n:r.e6.isRange(c)&&(d.selection=c),d},element:gt,focus:function(e,t,l){return new ut(t)},fragment:function(e,t,l){return vt(l)},selection:function(e,t,l){var n=l.find((e=>e instanceof dt)),a=l.find((e=>e instanceof ut));if(!n||null==n.offset||null==n.path)throw new Error("The <selection> hyperscript tag must have an <anchor> tag as a child with `path` and `offset` attributes defined.");if(!a||null==a.offset||null==a.path)throw new Error("The <selection> hyperscript tag must have a <focus> tag as a child with `path` and `offset` attributes defined.");return pt({anchor:{offset:n.offset,path:n.path},focus:{offset:a.offset,path:a.path}},t)},text:function(e,t,l){var n=vt(l);if(n.length>1)throw new Error("The <text> hyperscript tag must only contain a single node's worth of children.");var[a]=n;if(null==a&&(a={text:""}),!r.xv.isText(a))throw new Error("\n    The <text> hyperscript tag can only contain text content as children.");return ft.delete(a),Object.assign(a,t),a}},bt=e=>function(t,l){for(var n=arguments.length,a=new Array(n>2?n-2:0),r=2;r<n;r++)a[r-2]=arguments[r];var i=e[t];if(!i)throw new Error("No hyperscript creator found for tag: <".concat(t,">"));null==l&&(l={}),(0,o.P)(l)||(a=[l].concat(a),l={});var s=i(t,l,a=a.filter((e=>Boolean(e))).flat());return s},Nt=e=>{var t={},l=function(l){var n=e[l];if("object"!=typeof n)throw new Error("Properties specified for a hyperscript shorthand should be an object, but for the custom element <".concat(l,">  tag you passed: ").concat(n));t[l]=(e,t,l)=>gt(0,yt(yt({},n),t),l)};for(var n in e)l(n);return t},xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{elements:t={}}=e,l=Nt(t),n=yt(yt(yt({},wt),l),e.creators),a=bt(n);return a}();const kt={A:e=>({type:"link",newTab:"_blank"===e.getAttribute("target"),url:e.getAttribute("href")}),BLOCKQUOTE:()=>({type:"blockquote"}),H1:()=>({type:"h1"}),H2:()=>({type:"h2"}),H3:()=>({type:"h3"}),H4:()=>({type:"h4"}),H5:()=>({type:"h5"}),H6:()=>({type:"h6"}),LI:()=>({type:"li"}),OL:()=>({type:"ol"}),P:()=>({type:"p"}),PRE:()=>({type:"code"}),UL:()=>({type:"ul"})},_t={CODE:()=>({code:!0}),DEL:()=>({strikethrough:!0}),EM:()=>({italic:!0}),I:()=>({italic:!0}),S:()=>({strikethrough:!0}),STRONG:()=>({bold:!0}),U:()=>({underline:!0})},Mt=e=>{if(3===e.nodeType)return e.textContent;if(1!==e.nodeType)return null;if("BR"===e.nodeName)return"\n";const{nodeName:t}=e;let l=e;"PRE"===t&&e.childNodes[0]&&"CODE"===e.childNodes[0].nodeName&&([l]=e.childNodes);let n=Array.from(l.childNodes).map(Mt).flat();if(0===n.length&&(n=[{text:""}]),"BODY"===e.nodeName)return xt("fragment",{},n);if(kt[t]){const l=kt[t](e);return xt("element",l,n)}if(_t[t]){const l=_t[t](e);return n.map((e=>xt("text",l,e)))}return n},Lt=e=>{const{insertData:t}=e,l=e;return l.insertData=e=>{if(!e.types.includes("application/x-slate-fragment")){const t=e.getData("text/html");if(t){const e=(new DOMParser).parseFromString(t,"text/html"),n=Mt(e.body);return void r.YR.insertFragment(l,n)}}t(e)},l},Rt=(e,t)=>{const l=[...e];return(e.indexOf("ul")>-1||e.indexOf("ol")>-1)&&l.push("li"),l.reduce(((e,l)=>"object"==typeof l&&l.name?{...e,[l.name]:l}:"string"==typeof l&&t[l]?{...e,[l]:t[l]}:e),{})},St=["h1","h2","h3","h4","h5","h6","link"],Tt=e=>{const t=e;return t.shouldBreakOutOnEnter=e=>St.includes(String(e.type)),t};l(33329);const Bt=["h1","h2","h3","h4","h5","h6","ul","ol","indent","link","relationship","upload"],Ot=["bold","italic","underline","strikethrough","code"],Ct="rich-text",$t=w()((e=>{const{path:t,name:l,required:o,validate:s=g.richText,label:c,admin:d,admin:{readOnly:y,style:w,className:x,width:_,placeholder:M,description:L,condition:R,hideGutter:S}={}}=e,T=(null==d?void 0:d.elements)||Bt,B=(null==d?void 0:d.leaves)||Ot,C=t||l,{i18n:$}=(0,v.$)(),[z,H]=(0,n.useState)(!1),[Z,D]=(0,n.useState)({}),[P,Y]=(0,n.useState)({}),j=(0,n.useRef)(null),W=(0,n.useRef)(null),V=(0,G.D)()>1,A=(0,n.useCallback)((({attributes:t,children:l,element:a})=>{const r=Z[null==a?void 0:a.type],i=null==r?void 0:r.Element;return i?n.createElement(i,{attributes:t,element:a,path:C,fieldProps:e,editorRef:j},l):n.createElement("div",{...t},l)}),[Z,C,e]),F=(0,n.useCallback)((({attributes:t,children:l,leaf:a})=>{const r=Object.entries(P).filter((([e])=>a[e]));return r.length>0?r.reduce(((t,[l],r)=>{var i,o;if(null===(i=P[l])||void 0===i?void 0:i.Leaf){const i=null===(o=P[l])||void 0===o?void 0:o.Leaf;return n.createElement(i,{key:r,leaf:a,path:C,fieldProps:e,editorRef:j},t)}return t}),n.createElement("span",{...t},l)):n.createElement("span",{...t},l)}),[P,C,e]),U=(0,n.useCallback)(((e,t)=>s(e,{...t,required:o})),[s,o]),I=(0,E.Z)({path:C,validate:U,condition:R}),{value:q,showError:K,setValue:X,errorMessage:J,initialValue:Q}=I,ee=[Ct,"field-type",x,K&&"error",y&&`${Ct}--read-only`,!S&&`${Ct}--gutter`].filter(Boolean).join(" "),te=(0,n.useMemo)((()=>{let e=Tt((e=>{var t=e,{apply:l}=t;return t.history={undos:[],redos:[]},t.redo=()=>{var{history:e}=t,{redos:l}=e;if(l.length>0){var n=l[l.length-1];u.withoutSaving(t,(()=>{r.ML.withoutNormalizing(t,(()=>{for(var e of n)t.apply(e)}))})),e.redos.pop(),e.undos.push(n)}},t.undo=()=>{var{history:e}=t,{undos:l}=e;if(l.length>0){var n=l[l.length-1];u.withoutSaving(t,(()=>{r.ML.withoutNormalizing(t,(()=>{var e=n.map(r.OX.inverse).reverse();for(var l of e)t.apply(l)}))})),e.redos.push(n),e.undos.pop()}},t.apply=e=>{var{operations:n,history:a}=t,{undos:r}=a,i=r[r.length-1],o=i&&i[i.length-1],s=p(e,o),c=u.isSaving(t),d=u.isMerging(t);if(null==c&&(c=m(e)),c){if(null==d&&(d=null!=i&&(0!==n.length||h(e,o)||s)),i&&d)s&&i.pop(),i.push(e);else{var v=[e];r.push(v)}for(;r.length>100;)r.shift();f(e)&&(a.redos=[])}l(e)},t})((0,i.BU)((0,r.Jh)())));return e=Lt(e),e=nt(e,T),e=nt(e,B),e}),[T,B]),le=(0,n.useCallback)((e=>{const t=te.operations.filter((e=>!!e&&"set_selection"!==e.type));t&&Array.isArray(t)&&t.length>0&&(y||e===at.default||e===q||X(e))}),[te.operations,y,X,q]);if((0,n.useEffect)((()=>{if(!z){const e=Rt(T,et),t=Rt(B,O);D(e),Y(t),H(!0)}}),[z,T,B]),(0,n.useEffect)((()=>{function e(e){var t,l;const n='button, a, [role="button"]';[...(null===(t=W.current)||void 0===t?void 0:t.querySelectorAll(n))||[],...(null===(l=j.current)||void 0===l?void 0:l.querySelectorAll(n))||[]].forEach((t=>{const l="BUTTON"===t.tagName,n="disabled"===e;t.setAttribute("tabIndex",n?"-1":"0"),l&&t.setAttribute("disabled",n?"disabled":null)}))}return z&&y&&e("disabled"),()=>{z&&y&&e("enabled")}}),[z,y]),(0,n.useEffect)((()=>{Array.isArray(Q)&&Q.length>0&&(te.selection&&i.F3.deselect(te),te.history={redos:[],undos:[]})}),[Q,te]),!z)return null;let ne=q;if("string"==typeof ne)try{ne=JSON.parse(ne)}catch(e){}return ne||(ne=at.default),n.createElement("div",{className:ee,style:{...w,width:_}},n.createElement("div",{className:`${Ct}__wrap`},n.createElement(N.Z,{showError:K,message:J}),n.createElement(b.Z,{htmlFor:`field-${C.replace(/\./gi,"__")}`,label:c,required:o}),n.createElement(i.mH,{editor:te,value:ne,onChange:le},n.createElement("div",{className:`${Ct}__wrapper`},n.createElement("div",{className:[`${Ct}__toolbar`,V&&`${Ct}__drawerIsOpen`].filter(Boolean).join(" "),ref:W},n.createElement("div",{className:`${Ct}__toolbar-wrap`},T.map(((t,l)=>{let a;"object"==typeof t&&(null==t?void 0:t.name)&&(a=t.name),"string"==typeof t&&(a=t);const r=Z[a],i=null==r?void 0:r.Button;return i?n.createElement(i,{fieldProps:e,key:l,path:C}):null})),B.map(((t,l)=>{let a;"object"==typeof t&&(null==t?void 0:t.name)&&(a=t.name),"string"==typeof t&&(a=t);const r=P[a],i=null==r?void 0:r.Button;return i?n.createElement(i,{fieldProps:e,key:l,path:C}):null})))),n.createElement("div",{className:`${Ct}__editor`,ref:j},n.createElement(i.CX,{id:`field-${C.replace(/\./gi,"__")}`,className:`${Ct}__input`,renderElement:A,renderLeaf:F,placeholder:(0,ge.i)(M,$),spellCheck:!0,readOnly:y,onKeyDown:e=>{if("Enter"===e.key)if(e.shiftKey)e.preventDefault(),te.insertText("\n");else{const t=r.NB.descendant(te,te.selection.anchor.path.slice(0,-1));if(r.W_.isElement(t)&&te.shouldBreakOutOnEnter(t)){e.preventDefault();const t=r.NB.descendant(te,te.selection.anchor.path);r.xv.isText(t)&&String(t.text).length===te.selection.anchor.offset?r.YR.insertNodes(te,{children:[{text:""}]}):(r.YR.splitNodes(te),r.YR.setNodes(te,{}))}}if("Backspace"===e.key){const t=r.NB.descendant(te,te.selection.anchor.path.slice(0,-1));if(r.W_.isElement(t)&&"li"===t.type){const t=r.NB.descendant(te,te.selection.anchor.path);r.xv.isText(t)&&0===String(t.text).length&&(e.preventDefault(),r.YR.unwrapNodes(te,{match:e=>r.W_.isElement(e)&&Ne.includes(e.type),split:!0,mode:"lowest"}),r.YR.setNodes(te,{type:void 0}))}else te.isVoid(t)&&r.YR.removeNodes(te)}Object.keys(tt).forEach((t=>{if((0,a.ZP)(t,e)){e.preventDefault();k(te,tt[t])}}))}})))),n.createElement(rt.Z,{value:q,description:L})))}))}}]);